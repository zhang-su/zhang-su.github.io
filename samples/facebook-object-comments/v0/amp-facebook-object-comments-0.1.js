(self.AMP=self.AMP||[]).push({n:"amp-facebook-object-comments",v:"1497637175785",f:(function(AMP){var f="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)},h=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b}(this);function l(){l=function(){};h.Symbol||(h.Symbol=m)}var n=0;function m(b){return"jscomp_symbol_"+(b||"")+n++}
function p(){l();var b=h.Symbol.iterator;b||(b=h.Symbol.iterator=h.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&f(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return q(this)}});p=function(){}}function q(b){var a=0;return u(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})}function u(b){p();var a={next:b};a[h.Symbol.iterator]=function(){return this};return a}
function v(b,a){function c(){}c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;for(var d in a)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(a,d);e&&Object.defineProperty(b,d,e)}else b[d]=a[d]};var w=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function x(b){var a=Object.create(null);if(!b)return a;for(var c;c=w.exec(b);){var d=decodeURIComponent(c[1]).trim(),e=c[2]?decodeURIComponent(c[2]).trim():"";a[d]=e}return a};var y="";Date.now();self.log=self.log||{user:null,dev:null};var z=self.log;function A(){if(z.user)return z.user;throw Error("failed to call initLogConstructor");};var B,C;
function D(b){if("string"==typeof b){B||(B=self.document.createElement("a"),C=self.UrlCache||(self.UrlCache=Object.create(null)));var a=C[b];if(a)b=a;else{var c=B;c.href=b;c.protocol||(c.href=c.href);a={href:c.href,protocol:c.protocol,host:c.host,hostname:c.hostname,port:"0"==c.port?"":c.port,pathname:c.pathname,search:c.search,hash:c.hash,origin:null};"/"!==a.pathname[0]&&(a.pathname="/"+a.pathname);if("http:"==a.protocol&&80==a.port||"https:"==a.protocol&&443==a.port)a.port="",a.host=a.hostname;a.origin=
c.origin&&"null"!=c.origin?c.origin:"data:"!=a.protocol&&a.host?a.protocol+"//"+a.host:a.href;c=self;if(c.AMP_MODE)c=c.AMP_MODE;else{var d;if(c.context&&c.context.mode)d=c.context.mode;else{d=!(!self.AMP_CONFIG||!self.AMP_CONFIG.localDev);var e=self.AMP_CONFIG&&self.AMP_CONFIG.thirdPartyFrameHost;!(d="localhost"==c.location.hostname||d&&c.location.hostname==e)&&(d=c.location.ancestorOrigins&&c.location.ancestorOrigins[0])&&(d=c.location.ancestorOrigins[0],d=17>d.length?!1:0==d.lastIndexOf("http://localhost:",
0));d=!!d&&(!c.document||!!c.document.querySelector('script[src*="/dist/"],script[src*="/base/"]'));var e=x(c.location.originalHash||c.location.hash),g=x(c.location.search);y||(y=d?"1497637175785":c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"011497637175785");d={localDev:d,development:!("1"!=e.development&&!c.AMP_DEV_MODE),examiner:"2"==e.development,filter:e.filter,minified:!0,lite:void 0!=g.amp_lite,test:!(!c.AMP_TEST&&!c.__karma__),log:e.log,version:"1497637175785",
rtvVersion:y}}c=c.AMP_MODE=d}a=c.test&&Object.freeze?Object.freeze(a):a;b=C[b]=a}}(a="https:"==b.protocol||"localhost"==b.hostname)||(b=b.hostname,a=b.length-10,a=0<=a&&b.indexOf(".localhost",a)==a);return a}function E(b,a){var c;c=void 0===c?"source":c;A().assert(null!=b,"%s %s must be available",a,c);var d=b;A().assert(D(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',a,c,d);return d};function F(b){AMP.BaseElement.call(this,b);this.c=null;this.a=this.win.document.createElement("div");this.b=this.win.document.createElement("button")}v(F,AMP.BaseElement);F.prototype.buildCallback=function(){this.c=this.win.encodeURIComponent(E(this.element.getAttribute("object-id"),this.element));this.b.textContent="Login to view comments";this.a.classList.add("container");this.element.appendChild(this.a)};
F.prototype.isLayoutSupported=function(b){return"fixed"==b||"fixed-height"==b||"responsive"==b||"fill"==b||"flex-item"==b};
F.prototype.layoutCallback=function(){var b=this,a=x(this.win.location.hash.substring(1));a.access_token&&(G(this),this.win.localStorage.setItem("oauth2-fb",a.access_token));null!=this.win.localStorage.getItem("oauth2-fb")?H(this,this.c+"/comments?filter=stream"):(this.b.addEventListener("click",function(){return I(b)}),this.a.appendChild(this.b));this.applyFillContent(this.a);return this.loadPromise(this.a)};
function G(b){var a=b.win.location;b.win.history.replaceState("",b.win.document.title,a.pathname+a.search)}
function H(b,a){J(b,a).then(function(c){b.a.innerHTML="";var a;a=c.data;p();var e=a[Symbol.iterator];a=e?e.call(a):q(a);for(e=a.next();!e.done;e=a.next()){var g=e.value,e=b.win.document.createElement("div");e.classList.add("message");e.textContent=g.message;var r=b.win.document.createElement("div");r.textContent=g.from.name;r.classList.add("name");var t=b.win.document.createElement("div");t.textContent=(new Date(g.created_time)).toLocaleString();t.classList.add("created-time");var k=b.win.document.createElement("div");
k.classList.add("comment-container");k.appendChild(e);k.appendChild(r);k.appendChild(t);b.a.appendChild(k)}K(b,c.paging.previous,"Previous");K(b,c.paging.next,"Next");b.win.scrollTo(0,0)}).catch(function(b){return console.log(b)})}function K(b,a,c){if(a){var d=b.win.document.createElement("a");d.href="javascript:void(0)";d.textContent=c;d.addEventListener("click",function(){return H(b,a)});b.a.appendChild(d)}}
function J(b,a){var c;c=void 0===c?"GET":c;/\/\//.test(a)||(a="https://graph.facebook.com/v2.9/"+a);var d=b.win.localStorage.getItem("oauth2-fb");return b.win.fetch(a,{method:c,headers:new Headers({Authorization:"Bearer "+d})}).then(function(b){return b.json()}).then(function(a){if(a.error)throw a=a.error,"OAuthException"==a.type&&190==a.code&&I(b),Error(a.message);return a})}
function I(b){var a=b.win.document.createElement("form");a.setAttribute("method","GET");a.setAttribute("action","https://www.facebook.com/v2.9/dialog/oauth");var c={client_id:"733349513518212",redirect_uri:b.win.location.href,response_type:"token"},d;for(d in c){var e=b.win.document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("name",d);e.setAttribute("value",c[d]);a.appendChild(e)}b.win.document.body.appendChild(a);a.submit()}
AMP.registerElement("amp-facebook-object-comments",F,".container{background-color:#eee;font-family:Arial;font-size:15px;height:100%;padding:0 8px}.comment-container{background-color:#fff;border-radius:4px;box-shadow:4px 4px 4px 4px #ddd;margin:8px 0;padding:8px}.name{color:#888;font-size:13px}.created-time{color:#ccc;font-size:12px}a{margin:0 4px}\n/*# sourceURL=/extensions/amp-facebook-object-comments/0.1/amp-facebook-object-comments.css*/");
})});
//# sourceMappingURL=amp-facebook-object-comments-0.1.js.map

